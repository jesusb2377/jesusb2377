var ruinbase = 'Wydob3cgdG8gYXBwZWFyIGZ1bm55JywgJ3doeSBhcmUgbXkgdGh1bWJzIHVuZXZlbicsICdhbSBpIGxhY2sgdG9hc3QgYW5kIHRvbGVyYW50JywgJ3lvdXIgeW91cmUgZGlmZmVyZW5jZScsICd3aHkgZG9lc250IG15IHBvbyBmbG9hdCcsICdtaWRnZXQgZ29vZ2xlIGltYWdlcycsICd0YWxsIG1pZGdldHM/PycsICdob21lbWFkZSBsdWJlPycsICdpIGhhdGUgbXkgYm9zcycsICd3aGF0IGNvdW50cyBhcyBmYXQnLCAnaG93IHRvIHRlbGwgcGFydG5lciB0aGV5IGZhdCcsICdpcyBpdCBub3JtYWwgdG8gc3RpbGwgbG92ZSBteSBleCcsICdob3cgdG8gZ2V0IGJhY2sgd2l0aCBleCcsICdwZW5pcyByZW1vdmUgZG9nIGhvdyB0bycsICdyb21hbnRpYyB3YXlzIHRvIHByb3Bvc2UnLCAnZW5nYWdlbWVudCByaW5ncycsICdzZXggc2hvcCBpbiBteSBjaXR5JywgJ2hvdyB0byB0ZWxsIGlmIHBhcnRuZXIgY2hlYXRpbmcnLCAnd2F5cyB0byBraWxsIHNvbWVvbmUgaHlwb3RoZXRpY2FsbHknLCAndW5kZXRlY3RhYmxlIHBvaXNvbnMnLCAnaG93IHRvIGRlbGV0ZSBzZWFyY2ggaGlzdG9yeSBpbiBicm93c2VyJywgJ2FzaGxleSBtYWRpc29uIGhhY2snLCAndmlldyBhc2hsZXkgbWFkaXNvbiBsaXN0JywgJ2FzaGxleSBtYWRpc29uIGxpc3QgbXkgY2l0eScsICdwYXRlcm5pdHkgdGVzdCcsICdtYWlsIG9yZGVyIHBhdGVybml0eSB0ZXN0JywgJ2F0dHJhY3RlZCB0byBtb3RoZXIgd2h5JywgJ2lzIGluY2VzdCBpbGxlZ2FsIGluIHRoaXMgY291bnRyeScsICdsYXRlc3QgbGF3cyBpbmNlc3QnLCAnc2VkdWN0aW9uIGd1aWRlJywgJ3JvaHlwbm9sIHNhZmUgZG9zYWdlJywgJ3NtZWxseSBwZW5pcyBjdXJlIHVyZ2VudCcsICdjb21tb24gU1RJcycsICdTVEkgdGVzdCBpbiBteSBjaXR5JywgJ2F2ZXJhZ2UgcGVuaXMgc2l6ZSB0aGlzIGNvdW50cnknLCAnZG8gcGVuaXMgcHVtcHMgd29yaycsICdiZXN0IGJ1ZGdldCBwZW5pcyBwdW1wcycsICdkb2VzIGxpa2luZyBtZW4gbWVhbiBpbSBnYXknLCAnc2lnbnMgb2YgYmVpbmcgZ2F5JywgJ2hvdyB0byBjb21lIG91dCBhcyBnYXkgdG8gZGFkJywgJ2FnZSBvZiBjb25zZW50IGhlcmUnLCAnd2h5IGlzIGFnZSBvZiBjb25zZW50IHNvIG9sZCBoZXJlJywgJ2NvdW50cnkgbG93IGFnZSBvZiBjb25zZW50JywgJ2ZsaWdodHMgcGhpbGlwcGluZXMnLCAnaXNpcyBhcHBsaWNhdGlvbiBmb3JtJywgJ2hvdyB0byBqb2luIGlzaXMnLCAnY2hlYXAgc3lyaWEgZmxpZ2h0cyBmcm9tIGhlcmUnLCAnc3lyaWEgaG90ZWxzIHdpdGggcG9vbCcsICdiaW5nJywgJ2RvbmFsZCB0cnVtcCcsICdPSCBDT01FIE9OIERPTlQgSlVTVCBDT1BZIEFORCBQQVNURSBUSEUgTElTVCBGUk9NIFRIRSBBUlJBWSBZT1UgQ0hFRUtZIFNDQU1QJ10=';
var ruinedArr = eval(window.atob(ruinbase));

/*
ruinedArr =   [
  'how to appear funny',
  'why are my thumbs uneven',
  'am i lack toast and tolerant',
  'your youre difference',
  'why doesnt my poo float',
  'midget google images',
  'tall midgets??',
  'homemade lube?',
  'i hate my boss',
  'what counts as fat',
  'how to tell partner they fat',
  'is it normal to still love my ex',
  'how to get back with ex',
  'penis remove dog how to',
  'romantic ways to propose',
  'engagement rings',
  'sex shop in my city',
  'how to tell if partner cheating',
  'ways to kill someone hypothetically',
  'undetectable poisons',
  'how to delete search history in browser',
  'ashley madison hack',
  'view ashley madison list',
  'ashley madison list my city',
  'paternity test',
  'mail order paternity test',
  'attracted to mother why',
  'is incest illegal in this country',
  'latest laws incest',
  'seduction guide',
  'rohypnol safe dosage',
  'smelly penis cure urgent',
  'common STIs',
  'STI test in my city',
  'average penis size this country',
  'do penis pumps work',
  'best budget penis pumps',
  'does liking men mean im gay',
  'signs of being gay',
  'how to come out as gay to dad',
  'age of consent here',
  'why is age of consent so old here',
  'country low age of consent',
  'flights philippines',
  'isis application form',
  'how to join isis',
  'cheap syria flights from here',
  'syria hotels with pool',
  'bing',
  'donald trump',
  'OH COME ON DONT JUST COPY AND PASTE THE LIST FROM THE ARRAY YOU CHEEKY SCAMP'
]
*/

function userLocation(loc) {
    loc.country = loc.country.toLowerCase();
    loc.city = loc.city.toLowerCase();
    loc.regionName = loc.regionName.toLowerCase();
    if (window.matchMedia("(min-width: 690px)").matches) {
        for (var i = 0; i < ruinedArr.length; i++) {
            ruinedArr[i] = ruinedArr[i].replace(/from here/, loc.regionName).replace(/for here/, loc.regionName).replace(/here/, loc.regionName).replace(/this country/, loc.country).replace(/my city/, loc.city);
        }
    }
    if ((navigator.userAgent.indexOf("Opera") || navigator.userAgent.indexOf('OPR')) != -1) {
        browserName = 'opera';
    } else if (navigator.userAgent.indexOf("Chrome") != -1) {
        browserName = 'chrome';
    } else if (navigator.userAgent.indexOf("Safari") != -1) {
        browserName = 'safari';
    } else if (navigator.userAgent.indexOf("Firefox") != -1) {
        browserName = 'firefox';
    } else if ((navigator.userAgent.indexOf("MSIE") != -1) || (!!document.documentMode == true)) {
        browserName = 'internet explorer';
    }
    ruinedArr[20] = ruinedArr[20].replace(/browser/, browserName);
}
$(document).ready(function() {
    var coloursArr = ['#009900', '#1C8800', '#397700', '#556600', '#715500', '#8E4400', '#AA3300', '#C62200', '#E31100', '#FF0000'];
    var ruinedCount = 0,
        ruinTab = '',
        ruinBegin = false,
        colour = 0;

    function searchHandler() {
        $('h1#initial').attr('id', 'running');
        if (ruinTab == null || typeof(ruinTab) == 'undefined') {
            $('#ruinProgressText').html('Ruining aborted. Pussy.');
            ga('send', 'event', 'Search History Ruining', 'Stopped', 'undefined', ruinedCount);
        } else {
            ruinSearchQuery = ruinedArr[ruinedCount];
            ruinTab = window.open('https://www.google.com/search?q=' + encodeURI(ruinSearchQuery), 'ruinmysearchhistory');
            ruinedCount++;
            $('#ruinProgressText').html('Ruining your search history... (' + (ruinedCount * 2) + '%)');
            $('#ruinProgressBar').animate({
                "width": "+=2%"
            });
            var remainder = ruinedCount % 5;
            $('#ruinSearchesCompleted').prepend('<li id="newSearchEntry" style="font-size:' + (100 + (ruinedCount * 2)) + '%; color:' + coloursArr[colour] + '">' + ruinSearchQuery + '</li>');
            if (remainder == 0) {
                colour++;
            }
            $('#newSearchEntry').fadeIn().removeAttr('id');
            $('h1 #queryText').html(ruinSearchQuery);
            if (ruinedCount == 50) {
                $('#ruinProgressText').html('YOUR SEARCH HISTORY IS NOW RUINED.');
            } else {
                setTimeout(searchHandler, 1200);
            }
        }
    }
    $('button#magnifyingGlass').click(function() {
        if (ruinBegin) {
            return false;
        } else {
            ruinBegin = true;
        }
        searchHandler();
        $('#tagline').fadeOut(350);
        $('#email').hide();
    })
});
